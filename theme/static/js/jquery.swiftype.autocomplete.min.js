(function(a){var b=function(a){var b,c,d={};if(a==="")return{};for(b=0;b<a.length;b+=1){c=a[b].split('=');if(c.length===2)d[c[0]]=decodeURIComponent(c[1].replace(/\+/g," "));}return d;};a.queryParams=function(){return b(window.location.search.substr(1).split('&'));};a.hashParams=function(){return b(window.location.hash.substr(1).split('&'));};var c=0;window.Swiftype=window.Swiftype||{};Swiftype.root_url=Swiftype.root_url||'https://api.swiftype.com';Swiftype.pingUrl=function(a,b){var c=setTimeout(b,350);var d=new Image();d.onload=d.onerror=function(){clearTimeout(c);b();};d.src=a;return false;};Swiftype.pingAutoSelection=function(b,c,d,e){var f={t:new Date().getTime(),engine_key:b,doc_id:c,prefix:d};var g=Swiftype.root_url+'/api/v1/public/analytics/pas?'+a.param(f);Swiftype.pingUrl(g,e);};Swiftype.findSelectedSection=function(){var b=a.hashParams().sts;if(!b)return;function c(a){var b=a.replace(/\s+/g,'');b=b.toLowerCase();return b;}b=c(b);a('h1, h2, h3, h4, h5, h6').each(function(d){$this=a(this);if(c($this.text()).indexOf(b)>=0){this.scrollIntoView(true);return false;}});};Swiftype.htmlEscape=Swiftype.htmlEscape||function d(a){return String(a).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;');};a.fn.swiftype=function(b){Swiftype.findSelectedSection();var b=a.extend({},a.fn.swiftype.defaults,b);return this.each(function(){var d=a(this);var f=a.meta?a.extend({},b,d.data()):b;d.attr('autocomplete','off');d.data('swiftype-config-autocomplete',f);d.submitted=false;d.cache=new o(10);d.emptyQueries=[];d.isEmpty=function(b){return a.inArray(e(b),this.emptyQueries)>=0;};d.addEmpty=function(a){d.emptyQueries.unshift(e(a));};var g=f.dropdownStylesFunction(d);var i=a('<div class="swiftype-widget" />');var j=a('<div />').addClass(f.suggestionListClass).appendTo(i).css(g).hide();i.appendTo(f.autocompleteContainingElement);var k=a('<'+f.suggestionListType+' />').appendTo(j);d.data('swiftype-list',k);d.abortCurrent=function(){if(d.currentRequest)d.currentRequest.abort();};d.showList=function(){if(n(f.disableAutocomplete)===false)j.show();};d.hideList=function(a){if(a)j.hide();else setTimeout(function(){j.hide();},10);};d.focused=function(){return d.is(':focus');};d.submitting=function(){d.submitted=true;};d.listResults=function(){return a(f.resultListSelector,k);};d.activeResult=function(){return d.listResults().filter('.'+f.activeItemClass).first();};d.prevResult=function(){var a=d.listResults(),b=a.index(d.activeResult()),c=b-1,e=a.eq(c);d.listResults().removeClass(f.activeItemClass);if(c>=0)e.addClass(f.activeItemClass);};d.nextResult=function(){var a=d.listResults(),b=a.index(d.activeResult()),c=b+1,e=a.eq(c);d.listResults().removeClass(f.activeItemClass);if(c>=0)e.addClass(f.activeItemClass);};d.selectedCallback=function(a){return function(){var b=d.val(),c=function(){f.onComplete(a,b);};Swiftype.pingAutoSelection(f.engineKey,a.id,b,c);};};d.registerResult=function(a,b){a.data('swiftype-item',b);a.click(d.selectedCallback(b)).mouseover(function(){d.listResults().removeClass(f.activeItemClass);a.addClass(f.activeItemClass);});};d.getContext=function(){return{config:f,list:k,registerResult:d.registerResult};};var l;var m=false;d.lastValue='';d.keyup(function(a){if(m){m=false;return;}if(((a.which>36)&&(a.which<41))||(a.which==16))return;if(f.typingDelay>0){clearTimeout(l);l=setTimeout(function(){h(d);},f.typingDelay);}else h(d);});d.styleDropdown=function(){j.css(f.dropdownStylesFunction(d));};d.keydown(function(a){d.styleDropdown();var b=d.activeResult();switch(a.which){case 13:if((b.length!==0)&&(k.is(':visible'))){a.preventDefault();d.selectedCallback(b.data('swiftype-item'))();}else if(d.currentRequest)d.submitting();d.hideList();m=true;break;case 38:a.preventDefault();if(b.length===0)d.listResults().last().addClass(f.activeItemClass);else d.prevResult();break;case 40:a.preventDefault();if(b.length===0)d.listResults().first().addClass(f.activeItemClass);else if(b!=d.listResults().last())d.nextResult();break;case 27:d.hideList();m=true;break;default:d.submitted=false;break;}});d.keypress(function(a){if((a.which==13)&&(d.activeResult().length>0))a.preventDefault();});var p=false;var q=false;a(document).bind('mousedown.swiftype'+ ++c,function(){p=true;});a(document).bind('mouseup.swiftype'+c,function(){p=false;if(q){q=false;d.hideList();}});d.blur(function(){if(p)q=true;else d.hideList();});d.focus(function(){setTimeout(function(){d.select();},10);if(d.listResults().filter(':not(.'+f.noResultsClass+')').length>0)d.showList();});});};var e=function(b){return a.trim(b).toLowerCase();};var f=function(b,c){b.abortCurrent();var d={},f=b.data('swiftype-config-autocomplete');d.q=c;d.engine_key=f.engineKey;d.search_fields=n(f.searchFields);d.fetch_fields=n(f.fetchFields);d.filters=n(f.filters);d.document_types=n(f.documentTypes);d.functional_boosts=n(f.functionalBoosts);d.sort_field=n(f.sortField);d.sort_direction=n(f.sortDirection);d.per_page=f.resultLimit;var g=Swiftype.root_url+'/api/v1/public/engines/suggest.json';b.currentRequest=a.ajax({type:'GET',dataType:'jsonp',url:g,data:d}).success(function(a){var d=e(c);if(a.record_count>0)b.cache.put(d,a.records);else{b.addEmpty(d);b.data('swiftype-list').empty();b.hideList();return;}i(b,a.records,c);});};var g=function(a,b){var c=e(b);if(a.isEmpty(c)){a.data('swiftype-list').empty();a.hideList();return;}var d=a.cache.get(c);if(d)i(a,d,b);else f(a,b);};var h=function(b){var c=b.val();if(c===b.lastValue)return;b.lastValue=c;if(a.trim(c)===''){b.data('swiftype-list').empty();b.hideList();return;}if(typeof b.data('swiftype-config-autocomplete').engineKey!=='undefined')g(b,c);};var i=function(a,b,c){var d=a.data('swiftype-list'),e=a.data('swiftype-config-autocomplete');d.empty();a.hideList(true);e.resultRenderFunction(a.getContext(),b);var f=a.listResults().length;if((f>0&&a.focused())||(e.noResultsMessage!==undefined))if(a.submitted)a.submitted=false;else a.showList();};var j=function(b,c){var d=b.list,e=b.config;a.each(c,function(c,f){a.each(f,function(f,g){b.registerResult(a('<li>'+e.renderFunction(c,g)+'</li>').appendTo(d),g);});});};var k=function(a,b){return '<p class="title">'+Swiftype.htmlEscape(b.title)+'</p>';};var l=function(a,b){window.location=a.url;};var m=function(b){var c=b.data('swiftype-config-autocomplete');var d=c.attachTo?a(c.attachTo):b;var e=d.offset();var f={'position':'absolute','z-index':9999,'top':e.top+d.outerHeight()+1,'left':e.left};if(c.setWidth)f.width=d.outerWidth()-2;return f;};var n=function(a){if(a!==undefined){var b=a;if(typeof b==='function')b=b.call();return b;}return undefined;};function o(a){this.size=0;this.limit=a;this._keymap={};}o.prototype.put=function(a,b){var c={key:a,value:b};this._keymap[a]=c;if(this.tail){this.tail.newer=c;c.older=this.tail;}else this.head=c;this.tail=c;if(this.size===this.limit)return this.shift();else this.size++;};o.prototype.shift=function(){var a=this.head;if(a){if(this.head.newer){this.head=this.head.newer;this.head.older=undefined;}else this.head=undefined;a.newer=a.older=undefined;delete this._keymap[a.key];}return a;};o.prototype.get=function(a,b){var c=this._keymap[a];if(c===undefined)return;if(c===this.tail)return c.value;if(c.newer){if(c===this.head)this.head=c.newer;c.newer.older=c.older;}if(c.older)c.older.newer=c.newer;c.newer=undefined;c.older=this.tail;if(this.tail)this.tail.newer=c;this.tail=c;return b?c:c.value;};o.prototype.remove=function(a){var b=this._keymap[a];if(!b)return;delete this._keymap[b.key];if(b.newer&&b.older){b.older.newer=b.newer;b.newer.older=b.older;}else if(b.newer){b.newer.older=undefined;this.head=b.newer;}else if(b.older){b.older.newer=undefined;this.tail=b.older;}else this.head=this.tail=undefined;this.size--;return b.value;};o.prototype.clear=function(){this.head=this.tail=undefined;this.size=0;this._keymap={};};if(typeof Object.keys==='function')o.prototype.keys=function(){return Object.keys(this._keymap);};else o.prototype.keys=function(){var a=[];for(var b in this._keymap)a.push(b);return a;};a.fn.swiftype.defaults={activeItemClass:'active',attachTo:undefined,documentTypes:undefined,filters:undefined,engineKey:undefined,searchFields:undefined,functionalBoosts:undefined,sortField:undefined,sortDirection:undefined,fetchFields:undefined,noResultsClass:'noResults',noResultsMessage:undefined,onComplete:l,resultRenderFunction:j,renderFunction:k,dropdownStylesFunction:m,resultLimit:undefined,suggestionListType:'ul',suggestionListClass:'autocomplete',resultListSelector:'li',setWidth:true,typingDelay:80,disableAutocomplete:false,autocompleteContainingElement:'body'};})(jQuery);